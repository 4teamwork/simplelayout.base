<tal:if condition="not: here/portal_membership/isAnonymousUser"
        define="actions python:tuple(view.getActions());"
        i18n:domain="simplelayout">
<div class="sl-controls" tal:condition="actions">

    <tal:b
       tal:define="current_layout python: view.getCurrentLayout(here);
                   layouts python:tuple(view.getLayouts());
                   folderish python:here.isPrincipiaFolderish">
      <div class="sl-toggle-edit-bar-wrapper"
           title="Toggle edit bar"
           i18n:attributes="title action_sl-toogle">
          <div class="sl-toggle-edit-bar ui-icon ui-icon-triangle-1-e"></div>
      </div>
      <div class="sl-actions-wrapper">
          <ul class="sl-obj-actions"
              tal:condition="actions">

            <li class="document-action-dragme">
                <a href="#" title="Dragme" i18n:attributes="title action_sl-drag">
                    <!-- iefix -->
                </a>
            </li>

            <li tal:repeat="action view/getActions">
              <a href="" i18n:attributes="title"
                         tal:attributes="href action/url;
                                         title string:action_${action/id};
                                         class string:${action/id}-action;
                                         id here/id">
                <img src="" tal:attributes="src action/icon" />
              </a>
            </li>
          </ul>

          <ul class="sl-obj-layouts"
              tal:condition="python:layouts or (actions and folderish)">

            <tal:block
               tal:condition="layouts"
               tal:repeat="layout layouts">
              <li class="sl-layout"
                  tal:define="layout_name python:layout['id'][3:]"
                  tal:attributes="class python: 'sl-layout '+ (current_layout == layout_name and 'active' or '')">
                <a href="" i18n:attributes="title"
                           tal:attributes="href layout/url;
                                           id string:${here/UID}_${layout_name};
                                           title string:sl_layout_${layout_name}">
                  <img tal:attributes="src string:${context/portal_url}${layout/icon}" src="#"/>
                </a>
              </li>
            </tal:block>
          </ul>

          <div class="sl-workflowChanger" tal:condition="view/isWorkflowEnabled">
            <div tal:replace="structure provider:simplelayout.base.workflowmenu" />
          </div>
    </div>
    </tal:b>

    <span class="visualClear">&nbsp;</span>
</div>
</tal:if>
